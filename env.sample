# DeeperSensor API Environment Sample
# Copy to .env and adjust values.
# Profiles: set APP_ENV=local|production to toggle behavior.

# --- Application Runtime ---
APP_ENV=local
APP_NAME=deepersensor-api
APP_HOST=0.0.0.0
APP_PORT=8080
# Public base URL (used for CORS / links)
APP_PUBLIC_URL=http://localhost:8080

# --- Logging & Observability ---
RUST_LOG=info,api=debug
LOG_FORMAT=text               # text|json
REQUEST_ID_HEADER=X-Request-Id

# --- Security / Auth (placeholders; rotate in production) ---
JWT_SECRET=replace_with_secure_random_64_bytes
JWT_ISSUER=deepersensor
JWT_ACCESS_TTL_SECS=900       # 15m
JWT_REFRESH_TTL_SECS=1209600  # 14d
ALLOWED_ORIGINS=http://localhost:3000

# --- Rate Limiting ---
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_BURST=20
# Distinguish by IP when unauthenticated; by user after auth

# --- Upstream Model Provider (Ollama) ---
OLLAMA_BASE_URL=http://ollama:11434
OLLAMA_DEFAULT_TIMEOUT_MS=30000

# --- Redis (for rate limiting, sessions, caching) ---
REDIS_URL=redis://redis:6379/0

# --- Database (future Postgres; optional now) ---
DATABASE_URL=postgres://postgres:postgres@postgres:5432/deepersensor

# --- HTTP Server Tunables ---
SERVER_READ_TIMEOUT_SECS=15
SERVER_WRITE_TIMEOUT_SECS=30
SERVER_IDLE_TIMEOUT_SECS=120
MAX_REQUEST_SIZE_BYTES=1048576

# --- CORS & Security Headers ---
CORS_ALLOW_CREDENTIALS=false
CORS_ALLOW_HEADERS=Authorization,Content-Type
CORS_EXPOSE_HEADERS=Authorization,Content-Type
# Comma separated methods
CORS_ALLOW_METHODS=GET,POST,OPTIONS

# --- Nginx / Proxy (informational) ---
TRUSTED_PROXY_IPS=127.0.0.1,::1
FORCE_HTTPS=false

# --- Metrics / Telemetry (future) ---
METRICS_ENABLED=false
PROMETHEUS_BIND=0.0.0.0:9500

# --- Build / Misc ---
GIT_SHA=dev
